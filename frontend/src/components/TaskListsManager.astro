---
// TaskListsManager.astro - Componente para gestionar listas de tareas
import type { TaskList } from '../types';
import '../styles/components/TaskListsManager.css';

interface Props {
  id?: string;
}

const { id = 'taskListsManager' } = Astro.props;
---

<!-- Modal para gestionar listas -->
<div id={id} class="task-lists-modal" style="display: none;">
  <div class="task-lists-backdrop" onclick="window.closeTaskListsManager()"></div>
  <div class="task-lists-container">
    <div class="task-lists-header">
      <h2 class="task-lists-title">📋 Mis Listas de Tareas</h2>
      <div class="task-lists-actions">
        <button class="btn-create-list" onclick="window.openCreateListForm()">
          <span>+</span> Nueva Lista
        </button>
        <button class="task-lists-close" onclick="window.closeTaskListsManager()">&times;</button>
      </div>
    </div>
    
    <div class="task-lists-body">
      <!-- Lista de listas existentes -->
      <div class="lists-grid" id="listsGrid">
        <!-- Loading state -->
        <div class="lists-loading" id="listsLoading">
          <div class="loading-spinner"></div>
          <p>Cargando listas...</p>
        </div>
        
        <!-- Empty state -->
        <div class="lists-empty" id="listsEmpty" style="display: none;">
          <div class="empty-icon">📝</div>
          <h3>¡Sin listas aún!</h3>
          <p>Crea tu primera lista para organizar mejor tus tareas</p>
          <button class="btn-primary" onclick="window.openCreateListForm()">
            Crear Primera Lista
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal para crear/editar lista -->
<div id="listFormModal" class="task-form-modal" style="display: none;">
  <div class="task-form-backdrop" onclick="window.closeListForm()"></div>
  <div class="task-form-container">
    <div class="task-form-header">
      <h2 class="task-form-title" id="listFormTitle">Nueva Lista</h2>
      <button class="task-form-close" onclick="window.closeListForm()">&times;</button>
    </div>
    
    <form id="listFormElement" class="task-form-body">
      <input type="hidden" id="listId" name="id" />
      
      <div class="form-group">
        <label for="listName" class="form-label">Nombre *</label>
        <input 
          type="text" 
          id="listName" 
          name="name" 
          class="form-input" 
          placeholder="Ej: Trabajo, Personal, Estudios..."
          required
          maxlength="100"
        />
        <div class="form-error" id="listNameError"></div>
      </div>

      <div class="form-group">
        <label for="listDescription" class="form-label">Descripción</label>
        <textarea 
          id="listDescription" 
          name="description" 
          class="form-textarea" 
          rows="3"
          placeholder="Describe brevemente esta lista (opcional)"
          maxlength="255"
        ></textarea>
        <div class="form-error" id="listDescriptionError"></div>
      </div>

      <div class="form-actions">
        <button type="button" class="btn-secondary" onclick="window.closeListForm()">
          Cancelar
        </button>
        <button type="submit" class="btn-primary">
          <span id="listSubmitText">Crear Lista</span>
        </button>
      </div>
    </form>
  </div>
</div>
